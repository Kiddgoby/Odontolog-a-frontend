<div class="content">
    <div class="page-header">
        <h1>Tratamientos</h1>
        <button class="primary" (click)="abrirFormulario()">Añadir Tratamiento</button>
    </div>

    <div class="filters">
        <input type="text" placeholder="Buscar tratamientos..." [(ngModel)]="searchTerm" />

        <select [(ngModel)]="selectedCategory">
            <option *ngFor="let c of categorias" [value]="c">{{ c }}</option>
        </select>
    </div>

    <div class="layout">
        <div class="treatments-list">
            <div class="card" *ngFor="let t of tratamientosFiltrados">
                <div class="card-header">
                    <h3>{{ t.nombre }}</h3>
                    <span class="category">{{ t.categoria }}</span>
                </div>

                <p class="description">{{ t.descripcion }}</p>

                <div class="meta">
                    <span>{{ t.duracion }} min</span>
                    <span>€{{ t.precio }}</span>
                </div>

                <div class="actions">
                    <button (click)="editar(t)">Editar</button>
                    <button class="danger" (click)="eliminar(t.id)">Eliminar</button>
                </div>
            </div>
        </div>

        <!-- Formulario de Añadir/Editar -->
        <div class="form-wrapper" *ngIf="showForm">
            <h3>{{ isEditing ? 'Editar' : 'Nuevo' }} Tratamiento</h3>
            <form (submit)="guardar()">
                <label>
                    Nombre:
                    <input type="text" [(ngModel)]="currentTratamiento.nombre" name="nombre" required />
                </label>

                <label>
                    Categoría:
                    <select [(ngModel)]="currentTratamiento.categoria" name="categoria">
                        <option *ngFor="let c of categorias.slice(1)" [value]="c">{{ c }}</option>
                    </select>
                </label>

                <label>
                    Descripción:
                    <textarea [(ngModel)]="currentTratamiento.descripcion" name="descripcion" rows="3"></textarea>
                </label>

                <div class="row">
                    <label>
                        Duración (min):
                        <input type="number" [(ngModel)]="currentTratamiento.duracion" name="duracion" required />
                    </label>
                    <label>
                        Precio (€):
                        <input type="number" [(ngModel)]="currentTratamiento.precio" name="precio" required />
                    </label>
                </div>

                <div class="form-actions">
                    <button type="button" (click)="cerrarFormulario()">Cancelar</button>
                    <button type="submit" class="primary">{{ isEditing ? 'Actualizar' : 'Añadir' }}</button>
                </div>
            </form>
        </div>

    </div>
</div>